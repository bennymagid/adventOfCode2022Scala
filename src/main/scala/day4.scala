object day4 {
//  https://adventofcode.com/2022/day/4
private case class Rang(minNum: Int, maxNum: Int)

  private def stringToRang(s: String): Rang = {
    val spl = s.split("-")
    Rang(spl(0).toInt, spl(1).toInt)
  }
  private def doesContain(r1: Rang, r2: Rang): Boolean = {
    (r1.maxNum >= r2.maxNum && r1.minNum <= r2.minNum) ||
      (r2.maxNum >= r1.maxNum && r2.minNum <= r1.minNum)
  }

  private def doesOverlap(r1: Rang, r2: Rang): Boolean = {
    doesContain(r1, r2) ||
      (r1.minNum <= r2.maxNum && r1.maxNum >= r2.minNum) ||
      (r2.minNum <= r1.maxNum && r2.maxNum >= r1.minNum)
  }

  def main(args: Array[String]): Unit = {
    val example = "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8"
    val finalInput = "14-50,14-50\n43-44,43-87\n55-99,51-96\n67-68,68-91\n8-8,27-73\n22-92,21-92\n4-80,3-80\n10-67,34-67\n49-56,49-89\n27-96,27-28\n30-47,29-47\n75-75,16-74\n50-70,47-63\n9-89,10-88\n1-69,16-68\n9-76,52-76\n4-96,98-98\n28-66,11-29\n47-60,46-47\n37-88,36-88\n37-98,37-99\n9-88,87-88\n2-8,2-3\n29-98,29-46\n12-98,12-83\n85-99,19-98\n5-37,37-37\n52-99,52-99\n50-76,27-75\n57-59,29-58\n6-71,71-74\n61-77,62-77\n76-76,16-75\n3-27,4-27\n1-2,1-46\n4-74,4-73\n71-99,13-70\n29-92,30-92\n59-59,58-58\n49-54,50-51\n3-85,69-86\n26-76,66-66\n14-97,9-97\n43-44,7-45\n54-54,37-54\n2-91,4-68\n43-84,78-83\n4-97,3-97\n8-42,13-97\n26-95,2-16\n25-68,25-68\n4-57,3-62\n23-85,23-24\n68-78,32-74\n27-70,34-70\n6-70,69-71\n54-56,5-55\n21-54,21-54\n8-85,7-8\n46-57,45-63\n77-79,26-78\n9-37,8-37\n7-66,66-67\n76-93,93-93\n20-73,21-74\n12-13,12-14\n77-97,77-97\n12-92,13-13\n85-85,82-86\n80-91,18-74\n1-96,1-99\n29-31,30-30\n78-94,77-77\n32-45,3-58\n15-76,15-76\n49-73,73-97\n12-73,19-73\n95-95,22-94\n13-67,13-19\n4-5,6-99\n60-62,4-61\n16-54,16-55\n88-92,90-93\n33-40,40-86\n72-94,49-71\n4-94,5-48\n1-37,1-37\n18-84,83-84\n64-77,77-78\n93-93,92-93\n25-94,95-95\n10-41,6-41\n66-89,69-86\n21-97,22-97\n60-74,2-60\n39-60,54-59\n29-74,73-73\n44-61,43-61\n10-80,11-80\n79-80,4-83\n3-7,8-98\n40-47,48-68\n73-85,73-86\n72-85,73-85\n3-95,94-99\n63-64,11-64\n41-60,36-42\n2-45,6-10\n42-45,41-58\n9-77,73-75\n48-55,13-54\n23-33,23-24\n92-92,16-91\n83-97,84-97\n93-97,2-94\n34-80,33-62\n37-92,87-93\n67-67,32-67\n1-72,7-71\n57-85,86-88\n53-56,50-53\n97-99,3-98\n3-6,8-93\n22-81,22-99\n53-77,53-53\n97-99,3-98\n35-55,35-55\n30-30,30-95\n27-94,28-37\n30-68,57-79\n30-84,83-85\n16-22,14-21\n95-95,2-95\n34-45,35-51\n16-36,12-17\n3-3,3-95\n8-77,6-78\n4-89,6-86\n77-83,76-88\n43-43,37-42\n41-62,44-97\n67-86,85-87\n82-96,99-99\n75-92,80-83\n12-29,12-29\n82-94,18-81\n9-93,97-97\n83-93,79-84\n90-97,17-90\n29-32,22-31\n14-48,3-81\n72-84,63-84\n7-98,6-97\n6-83,6-82\n6-83,58-93\n2-62,11-80\n77-77,76-82\n36-37,36-60\n1-84,7-83\n10-48,32-72\n2-51,25-48\n22-96,18-99\n99-99,55-95\n5-59,1-60\n65-70,4-69\n10-91,10-90\n6-98,1-7\n83-90,88-91\n39-39,24-38\n34-87,4-35\n86-88,15-85\n44-52,43-44\n1-81,53-99\n85-88,85-99\n87-87,63-87\n96-99,1-96\n20-22,21-23\n32-57,33-56\n4-89,4-90\n16-81,17-52\n83-99,16-84\n14-21,15-16\n38-80,79-86\n60-81,59-99\n90-93,15-89\n2-74,75-78\n3-91,18-67\n22-91,22-22\n16-19,18-83\n9-81,10-91\n2-98,2-49\n93-94,77-94\n28-92,11-93\n36-99,36-97\n32-48,48-48\n11-14,15-71\n5-81,5-56\n23-61,23-24\n92-94,23-93\n3-40,7-98\n28-98,99-99\n2-62,50-63\n20-43,18-18\n38-51,50-51\n3-11,37-46\n8-95,2-7\n96-98,23-73\n73-92,73-73\n96-99,1-97\n2-83,83-88\n12-73,99-99\n13-86,12-87\n87-87,23-87\n95-96,40-71\n18-42,18-92\n29-61,23-62\n59-97,58-93\n35-74,34-75\n8-94,9-95\n15-65,76-82\n26-89,16-97\n53-71,11-85\n5-51,3-51\n21-43,22-76\n33-33,23-32\n10-29,9-30\n87-88,87-96\n2-50,3-51\n23-83,22-87\n15-96,95-97\n10-77,9-78\n67-95,67-95\n17-18,18-64\n2-9,8-83\n8-51,50-51\n92-92,2-92\n6-16,5-15\n32-47,37-49\n15-81,75-96\n34-75,49-71\n6-71,6-71\n15-92,91-92\n43-91,43-91\n50-78,49-77\n35-56,55-55\n45-77,76-77\n9-76,9-91\n7-88,7-88\n51-72,50-51\n21-98,7-44\n35-89,35-89\n17-87,4-87\n60-75,61-61\n92-96,45-93\n47-59,46-58\n4-97,1-28\n38-39,37-39\n9-63,24-84\n8-94,14-93\n49-86,58-85\n10-13,8-42\n98-98,41-93\n25-75,26-92\n5-80,79-81\n6-56,23-56\n17-94,94-94\n87-87,34-87\n55-57,55-69\n48-80,37-47\n99-99,2-99\n38-57,37-56\n63-86,62-86\n97-97,24-98\n18-61,17-60\n10-68,6-42\n86-86,11-86\n9-24,24-24\n17-73,72-72\n12-97,13-98\n5-83,29-84\n5-45,79-95\n36-36,51-86\n3-63,2-86\n1-65,17-36\n7-7,6-9\n5-5,5-99\n8-48,7-46\n3-83,1-84\n28-76,29-77\n65-94,3-95\n14-53,15-50\n1-29,15-41\n9-86,9-94\n30-97,29-48\n74-86,78-83\n2-17,3-17\n83-83,29-82\n16-76,96-96\n3-63,4-63\n2-98,2-98\n15-98,14-97\n2-13,14-62\n31-76,75-77\n97-97,28-98\n87-87,82-87\n37-45,38-46\n17-39,21-42\n23-67,43-62\n3-43,3-4\n67-91,67-80\n10-91,10-11\n1-97,6-97\n29-97,99-99\n78-78,18-77\n5-98,6-98\n49-86,87-96\n6-84,7-7\n1-92,1-92\n33-51,24-32\n15-85,2-86\n67-86,67-92\n4-78,6-90\n15-92,8-92\n12-93,94-99\n12-67,32-96\n73-95,74-96\n35-45,35-42\n68-69,67-77\n16-70,7-16\n84-86,21-85\n12-19,5-18\n82-94,94-95\n8-27,28-28\n55-93,11-93\n31-86,98-99\n41-65,41-64\n56-76,31-57\n15-41,7-41\n92-94,7-93\n5-24,25-39\n5-25,24-24\n3-3,3-20\n52-92,91-91\n16-94,16-95\n3-85,1-86\n38-90,38-90\n35-36,35-98\n7-18,7-8\n12-35,12-36\n6-89,31-33\n37-56,40-67\n1-98,1-99\n2-96,2-99\n13-49,13-19\n9-99,51-77\n3-87,74-88\n69-69,17-69\n39-98,38-43\n20-42,19-57\n57-99,35-56\n90-98,89-89\n9-71,8-70\n5-72,5-38\n37-91,4-37\n46-87,10-93\n9-78,8-77\n58-58,11-59\n8-13,14-95\n76-84,75-83\n27-77,1-27\n17-96,14-55\n50-55,33-55\n86-99,86-92\n58-81,81-81\n88-88,70-88\n36-36,18-36\n57-59,11-58\n5-6,6-15\n94-97,39-94\n27-63,27-80\n35-57,36-58\n4-83,8-83\n84-91,15-64\n10-43,44-79\n51-51,16-51\n4-97,5-98\n10-36,22-29\n3-90,56-87\n63-90,83-98\n53-75,52-74\n89-96,29-88\n66-99,21-98\n14-19,19-86\n27-27,26-65\n75-82,18-76\n11-95,94-98\n77-78,78-90\n13-15,14-72\n11-88,25-88\n23-23,22-46\n32-41,33-78\n54-90,39-60\n14-71,15-68\n3-95,95-95\n29-73,72-73\n20-33,20-33\n33-61,33-85\n15-92,15-95\n7-77,43-68\n50-55,54-55\n38-65,38-64\n43-68,54-77\n15-58,15-51\n2-38,3-46\n36-36,36-73\n9-70,10-71\n79-83,82-88\n55-86,55-55\n19-57,18-60\n26-31,27-76\n14-66,3-13\n94-97,2-95\n10-98,21-94\n20-44,21-44\n47-99,46-99\n13-31,21-24\n1-99,99-99\n17-92,53-93\n54-74,53-74\n8-16,16-98\n10-98,10-99\n18-67,68-89\n38-77,76-85\n26-66,25-67\n9-35,35-94\n10-43,11-44\n69-92,4-38\n48-84,15-49\n5-50,23-51\n9-27,27-71\n21-99,21-21\n4-97,97-99\n41-53,2-52\n11-66,2-57\n32-75,16-31\n7-59,6-58\n45-97,93-96\n14-71,10-71\n50-98,37-49\n29-76,77-77\n78-80,79-80\n23-30,22-30\n4-5,4-98\n17-35,35-36\n16-42,42-43\n50-92,19-51\n29-57,29-56\n27-75,3-80\n10-62,62-62\n48-76,24-49\n71-73,2-72\n38-42,40-41\n24-74,25-30\n4-22,1-21\n6-47,6-46\n31-36,31-85\n6-98,8-98\n98-99,52-98\n34-90,49-91\n44-88,45-89\n33-94,94-95\n6-91,3-6\n6-8,5-87\n8-97,75-98\n45-75,94-94\n60-80,60-99\n97-97,30-98\n15-16,15-79\n40-67,63-96\n24-94,22-93\n6-57,8-57\n8-97,97-97\n83-83,44-78\n13-17,20-95\n8-56,56-87\n7-96,1-96\n21-88,22-82\n2-44,2-44\n10-93,14-66\n10-98,10-82\n4-55,1-1\n4-5,4-98\n21-29,28-29\n67-82,24-33\n26-99,26-27\n46-74,73-74\n83-83,71-83\n33-52,23-53\n53-89,30-52\n35-67,51-67\n24-87,86-98\n21-96,21-64\n92-93,30-92\n32-41,41-94\n99-99,6-97\n98-99,4-95\n3-74,2-74\n50-50,20-51\n4-19,18-18\n8-94,3-95\n23-84,59-65\n34-75,74-74\n57-92,17-94\n40-42,41-84\n29-62,29-97\n94-97,99-99\n66-70,66-71\n98-99,22-99\n26-72,26-55\n11-66,11-94\n8-91,8-87\n50-74,44-88\n71-76,71-72\n1-65,1-65\n61-89,1-88\n8-12,8-15\n92-94,14-92\n4-95,1-95\n24-96,24-90\n34-75,27-74\n13-77,18-94\n21-89,13-90\n10-96,9-10\n43-56,24-56\n9-14,9-10\n3-95,31-95\n36-52,43-46\n29-44,44-96\n20-96,13-97\n45-78,36-84\n8-72,9-72\n96-99,42-97\n14-75,76-76\n48-71,61-72\n18-78,17-77\n4-37,2-2\n9-98,4-8\n29-51,49-52\n67-80,52-80\n24-24,22-57\n11-80,11-80\n19-22,79-86\n47-87,47-87\n58-70,58-71\n44-67,44-54\n2-63,2-96\n8-28,7-70\n3-20,20-21\n35-69,69-95\n2-18,1-18\n4-92,91-93\n31-70,31-71\n46-48,11-47\n75-77,23-76\n78-78,24-77\n8-71,8-13\n19-85,26-73\n64-82,88-99\n30-74,4-74\n3-15,1-15\n44-57,43-45\n36-99,35-96\n14-84,8-84\n2-84,11-80\n19-36,37-37\n38-61,60-85\n28-76,27-29\n63-65,52-64\n84-86,1-85\n45-45,9-45\n5-71,3-96\n42-44,35-45\n41-72,41-73\n4-62,2-51\n14-29,14-29\n10-11,11-91\n95-95,1-96\n6-80,5-78\n31-68,69-87\n5-80,80-81\n5-91,8-68\n15-86,98-99\n49-88,49-84\n4-15,16-73\n31-79,64-65\n85-85,5-85\n21-47,17-20\n13-87,25-78\n94-94,1-93\n4-96,3-96\n22-61,6-61\n3-85,2-80\n16-17,17-66\n23-67,67-67\n13-83,55-83\n97-97,63-98\n17-62,17-17\n43-61,44-80\n47-56,52-59\n48-87,87-96\n49-50,75-88\n5-95,5-95\n5-72,7-71\n16-51,50-51\n25-80,11-79\n23-91,24-91\n94-96,48-95\n17-99,17-17\n3-68,67-68\n15-84,9-85\n29-87,26-87\n88-91,87-96\n6-70,69-70\n40-58,34-43\n19-98,39-98\n3-96,3-95\n38-86,85-88\n32-71,47-63\n62-88,14-99\n24-54,94-95\n14-26,15-15\n29-86,19-87\n7-83,10-84\n4-95,96-96\n45-55,45-54\n9-71,27-93\n27-85,45-85\n32-79,2-77\n34-79,20-78\n8-20,12-20\n5-6,6-91\n14-34,14-35\n19-67,73-74\n5-95,5-96\n23-96,3-23\n30-51,15-52\n39-52,35-51\n45-45,28-44\n8-15,16-16\n3-90,2-75\n36-84,36-84\n86-97,86-97\n20-93,67-92\n18-43,16-90\n1-12,13-98\n12-93,11-50\n15-79,15-93\n77-82,59-78\n31-92,32-93\n27-79,28-90\n4-76,32-85\n26-46,45-45\n85-89,85-96\n28-43,28-95\n37-97,20-96\n2-64,64-64\n46-51,47-87\n82-88,7-82\n14-48,44-46\n25-99,25-25\n31-31,30-71\n23-89,88-90\n55-83,38-92\n19-67,11-68\n16-32,17-71\n59-79,79-81\n28-95,23-28\n86-96,11-87\n20-46,31-49\n5-6,5-49\n15-79,15-90\n95-97,3-96\n17-19,18-57\n56-82,57-98\n92-92,47-91\n88-89,89-91\n97-98,6-96\n7-89,8-63\n49-85,2-50\n74-75,62-75\n14-35,15-35\n11-64,5-46\n2-6,5-83\n58-95,28-81\n28-73,29-29\n84-93,30-83\n41-97,97-98\n22-48,22-48\n54-90,76-90\n88-99,8-89\n67-94,68-68\n51-55,51-90\n40-58,44-89\n60-78,60-77\n23-69,23-85\n34-85,35-86\n87-99,16-75\n34-96,96-98\n39-72,12-72\n25-92,92-94\n8-73,73-82\n12-92,13-95\n30-92,55-98\n37-37,10-38\n31-38,34-34\n54-88,2-85\n12-42,41-41\n5-97,96-97\n82-82,20-83\n3-24,1-24\n20-96,96-96\n33-99,34-54\n26-93,26-37\n21-58,21-58\n61-86,2-47\n5-65,4-98\n2-66,2-99\n64-66,15-65\n11-75,2-58\n55-75,47-93\n37-58,36-58\n21-71,21-71\n45-92,40-58\n18-40,37-43\n33-65,33-65\n43-84,91-93\n13-13,13-80\n30-84,31-72\n38-98,39-98\n42-88,91-98\n10-91,9-10\n56-66,67-94\n55-87,54-78\n9-96,9-95\n18-63,7-64\n9-28,27-29\n32-67,16-68\n1-9,15-45\n34-44,34-80\n98-98,89-99\n9-68,10-96\n42-43,26-43\n82-90,91-93\n21-21,11-21\n7-58,5-95\n93-95,60-93\n7-40,8-94\n25-26,26-96\n8-98,7-98\n23-87,24-87\n9-51,10-48\n21-99,18-98\n32-79,7-55\n2-99,1-99\n11-85,3-85\n2-85,1-85\n21-83,59-70\n33-33,32-34\n21-60,22-43\n14-29,14-28\n35-55,34-54\n50-59,50-50\n39-68,67-85\n14-21,6-79\n26-47,47-87\n2-82,82-89\n46-55,46-47\n6-86,87-87\n60-60,8-64\n27-28,28-79\n1-2,1-98\n11-85,84-89\n12-27,20-21\n6-93,9-90\n6-92,2-98\n77-86,25-76\n37-62,79-82\n69-97,36-96\n7-92,99-99\n73-73,32-74\n92-97,62-95\n41-96,51-96\n22-97,34-96\n25-26,26-50\n11-86,12-87\n68-84,4-82\n14-87,46-86\n28-30,29-68\n1-68,2-45\n6-92,5-94\n2-28,36-77\n5-11,5-24\n35-91,29-91\n40-93,7-94\n70-96,10-69\n67-96,10-66\n67-67,67-67\n1-63,3-63\n9-95,8-95\n78-78,37-79\n47-48,47-79\n14-93,14-14\n24-96,31-96\n29-29,6-30\n60-67,60-67\n80-80,2-81\n24-85,30-84\n66-73,72-82\n58-97,59-97\n9-9,9-95\n21-42,22-42\n5-35,3-6\n39-98,97-98\n85-96,44-97\n65-98,11-97\n2-94,2-95\n64-96,66-97\n2-99,2-95\n32-51,32-43\n4-11,11-40\n1-64,1-1\n89-96,19-88\n11-32,12-17\n5-98,5-98\n17-98,16-96\n18-71,17-98\n37-75,37-71\n37-92,37-92\n7-88,38-76\n3-13,12-52\n6-96,7-97\n91-99,2-90\n30-95,30-31\n9-27,9-59\n72-78,39-72\n23-30,27-84\n75-92,26-74\n30-36,31-35\n55-55,24-54\n32-71,32-33\n6-88,87-96\n16-97,15-96\n44-81,81-98\n63-92,40-64\n70-70,14-71\n33-59,34-36\n13-26,13-62\n64-86,2-85\n38-90,37-90\n71-80,16-81\n10-41,17-97\n11-74,10-74\n88-96,85-89\n3-64,1-65\n71-79,78-95\n25-39,25-40\n18-98,2-99\n42-43,43-66\n2-90,3-91\n8-86,86-94\n10-97,98-99\n3-99,13-51\n35-84,72-84\n26-27,13-27\n10-71,2-87\n71-82,72-80\n60-87,28-64\n58-79,44-78\n1-98,2-98\n28-99,26-50\n12-77,27-76\n5-57,56-56\n29-43,29-43\n41-86,10-41\n45-69,44-69\n14-91,15-91\n42-57,62-73\n24-30,24-26\n57-64,62-65\n14-47,14-15\n3-88,79-89\n2-4,4-80\n54-90,10-89\n6-47,6-47\n66-68,65-70\n82-85,9-84\n73-91,73-79\n83-96,16-82\n93-96,41-72\n6-41,40-81\n7-53,3-7\n85-96,84-89\n9-20,10-71\n25-44,43-45\n2-99,99-99\n7-95,8-96\n50-53,49-53\n9-26,10-26\n3-50,47-50\n40-59,60-60\n66-71,72-72\n3-74,1-75\n43-79,25-80\n29-30,29-31\n8-50,58-68\n41-96,42-96\n62-64,62-81\n4-88,5-88\n2-93,2-92\n57-58,58-88\n56-84,31-80\n90-91,4-90\n8-72,40-73\n41-76,41-53\n57-57,5-62\n20-40,19-39\n74-77,21-80\n1-64,4-97\n13-48,48-88\n21-28,4-28\n14-16,14-14\n9-24,5-25\n20-67,17-18\n66-81,67-98\n22-61,23-57\n31-67,66-67\n14-75,74-76\n12-95,13-97\n49-51,1-50\n1-74,12-75\n4-93,94-94\n76-80,98-99\n74-79,78-80\n35-79,22-80\n30-89,88-89\n31-77,31-94\n73-90,89-94\n7-83,7-98\n5-98,4-6\n4-99,96-98\n19-75,18-75\n9-99,9-99\n69-75,6-68\n48-69,47-85\n7-80,6-87\n28-35,7-99\n59-60,41-59\n28-64,27-64\n5-97,1-73\n33-88,89-94\n20-98,10-98\n9-12,10-83\n11-73,74-90\n28-86,85-87\n14-56,56-90\n47-98,46-98\n11-83,82-83\n16-46,45-47\n98-98,1-98\n32-72,33-41\n3-62,2-62\n47-48,25-47\n12-46,5-46\n10-78,10-10\n18-95,4-94\n24-81,9-70\n6-98,90-97\n3-55,38-60\n55-68,55-67\n22-80,22-82\n6-70,7-7\n13-15,12-18\n54-95,38-89\n19-93,42-93\n65-92,93-97\n50-93,50-63\n50-99,50-99\n49-49,3-48\n4-54,4-54\n48-49,49-80\n1-4,3-3\n66-98,17-67\n56-70,55-93\n51-95,51-51\n64-73,37-65\n21-72,37-76\n45-73,46-73\n35-38,36-39\n17-36,17-37\n98-98,17-99"
    val listToRang = finalInput.split("\n")
      .map(p => p.split(",").map(stringToRang))
    val pt1 = listToRang.map(a => doesContain(a(0), a(1)))
    val pt2 = listToRang.map(a => doesOverlap(a(0), a(1)))
    println(pt1.count(identity))
    pt2.foreach(println)
    println(pt2.count(identity))
  }
}
